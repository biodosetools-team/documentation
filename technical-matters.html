<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Technical matters | Biodose Tools</title>
<meta name="author" content="Alfredo Hernández, Joan Francesc Barquinero">
<meta name="description" content="Biodose Tools has been developed following international guidelines of biological dosimetry . Despite our best efforts to ensure that {biodosetools} automatically handles mathematical errors...">
<meta name="generator" content="bookdown 0.30 with bs4_book()">
<meta property="og:title" content="Chapter 6 Technical matters | Biodose Tools">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta property="og:description" content="Biodose Tools has been developed following international guidelines of biological dosimetry . Despite our best efforts to ensure that {biodosetools} automatically handles mathematical errors...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Technical matters | Biodose Tools">
<meta name="twitter:description" content="Biodose Tools has been developed following international guidelines of biological dosimetry . Despite our best efforts to ensure that {biodosetools} automatically handles mathematical errors...">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="icon" type="image/x-icon" href="favicon.png">
<link rel="icon" sizes="192x192" href="favicon-highres.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="User Manual &amp; Documentation">Biodose Tools</a>:
        <small class="text-muted">User Manual &amp; Documentation</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="package.html"><span class="header-section-number">2</span> Package implementation</a></li>
<li class="book-part">Using Biodose Tools</li>
<li><a class="" href="manual-get.html"><span class="header-section-number">3</span> Getting Biodose Tools</a></li>
<li><a class="" href="manual-use-shiny.html"><span class="header-section-number">4</span> Usage (web UI)</a></li>
<li><a class="" href="manual-use-r.html"><span class="header-section-number">5</span> Usage (R API)</a></li>
<li><a class="active" href="technical-matters.html"><span class="header-section-number">6</span> Technical matters</a></li>
<li class="book-part">Statistical Methods</li>
<li><a class="" href="stats-considerations.html"><span class="header-section-number">7</span> Statistical considerations</a></li>
<li><a class="" href="stats-fitting.html"><span class="header-section-number">8</span> Dose-effect curve fitting</a></li>
<li><a class="" href="stats-estimation.html"><span class="header-section-number">9</span> Uncertainty on dose estimation</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="appendix-feedback.html"><span class="header-section-number">A</span> Feedback and issues</a></li>
<li><a class="" href="appendix-cite.html"><span class="header-section-number">B</span> How to cite Biodose Tools</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/biodosetools-team/documentation">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="technical-matters" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Technical matters<a class="anchor" aria-label="anchor" href="#technical-matters"><i class="fas fa-link"></i></a>
</h1>
<p>Biodose Tools has been developed following international guidelines of biological dosimetry .</p>
<p>Despite our best efforts to ensure that {biodosetools} automatically handles mathematical errors behind the scenes, such as using a constraint maximum-likelihood optimisation method <span class="citation">(<a href="references.html#ref-Oliveira2016" role="doc-biblioref">Oliveira et al. 2016</a>)</span> when the fitting using a generalized linear model (GLM) is not possible, or correcting negative dose estimates, if the aberration distributions are not well constructed,the resulting curves may still result in errors (both using the {shiny} app or the R API) when performing dose estimation. As an example, let us consider the following curve, shown in Table <a href="technical-matters.html#tab:dic-count-data-bad">6.1</a> and Figure <a href="technical-matters.html#fig:dic-fit-dose-curve-bad">6.1</a>. Although at a glance we can already suspect that there is some kind of issue in the observed counts, due to the low number of evaluated cells, one may still decide to proceed and use it for dose estimations.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:dic-count-data-bad">Table 6.1: </span>Example of dicentric distribution within cells.</caption>
<thead><tr class="header">
<th align="center">D</th>
<th align="center">N</th>
<th align="center">X</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0.00</td>
<td align="center">100</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0.25</td>
<td align="center">200</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">0.50</td>
<td align="center">161</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">1.00</td>
<td align="center">88</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">1.50</td>
<td align="center">131</td>
<td align="center">28</td>
</tr>
<tr class="even">
<td align="center">2.00</td>
<td align="center">74</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td align="center">2.50</td>
<td align="center">189</td>
<td align="center">70</td>
</tr>
<tr class="even">
<td align="center">3.00</td>
<td align="center">141</td>
<td align="center">61</td>
</tr>
</tbody>
</table></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dic-fit-dose-curve-bad"></span>
<img src="biodose-tools_files/figure-html/dic-fit-dose-curve-bad-1.png" alt="Plot of dose-effect curve constructed from the dicentric distribution in Table \@ref(tab:dic-count-data-bad)." width="100%"><p class="caption">
Figure 6.1: Plot of dose-effect curve constructed from the dicentric distribution in Table <a href="technical-matters.html#tab:dic-count-data-bad">6.1</a>.
</p>
</div>
<p>In Table <a href="technical-matters.html#tab:dic-case-data-bad">6.2</a> below we can see an example of a case we may want to estimate the dose for. If we try to estimate the dose using Merkle’s method, we encounter an error involving the <code><a href="https://rdrr.io/r/stats/uniroot.html">uniroot()</a></code> function. The function <code><a href="https://rdrr.io/r/stats/uniroot.html">uniroot()</a></code> searches for a root (i.e., zero) of the function <span class="math inline">\(f(x_{1}, \dots, x_{n})\)</span> with respect to its first argument <span class="math inline">\(x_{1}\)</span> within a specified interval. In our example, this error occurs when projecting the upper 95% confidence limit of the yield <span class="math inline">\(\lambda_{U}\)</span> into the lower curve <a href="stats-estimation.html#eq:merkle-dose-estimation-error">(9.1)</a>. The reason for this is that the lower 95% confidence band of the dose-effect curve is not a monotonically increasing function, meaning that <span class="math inline">\(D_{L}\)</span> has multiple possible numerical solutions, as shown in Figure <a href="technical-matters.html#fig:dic-fit-dose-curve-bad-extended">6.2</a>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:dic-case-data-bad">Table 6.2: </span>Example of dicentric distribution within cells.</caption>
<colgroup>
<col width="4%">
<col width="4%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="27%">
<col width="26%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="center"><span class="math inline">\(N\)</span></th>
<th align="center"><span class="math inline">\(X\)</span></th>
<th align="center"><span class="math inline">\(C_{0}\)</span></th>
<th align="center"><span class="math inline">\(C_{1}\)</span></th>
<th align="center"><span class="math inline">\(C_{2}\)</span></th>
<th align="center"><span class="math inline">\(y\)</span></th>
<th align="center"><span class="math inline">\(\hat{\sigma}_{y} / \sqrt{N}\)</span></th>
<th align="center"><span class="math inline">\(\hat{\sigma}^{2} / \bar{y}\)</span></th>
<th align="center"><span class="math inline">\(u\)</span></th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">148</td>
<td align="center">13</td>
<td align="center">136</td>
<td align="center">11</td>
<td align="center">1</td>
<td align="center">0.088</td>
<td align="center">0.025</td>
<td align="center">1.073</td>
<td align="center">0.654</td>
</tr></tbody>
</table></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dic-fit-dose-curve-bad-extended"></span>
<img src="biodose-tools_files/figure-html/dic-fit-dose-curve-bad-extended-1.png" alt="Plot of dose-effect curve constructed from the dicentric distribution in Table \@ref(tab:dic-count-data-bad) over an extended $D$ range." width="100%"><p class="caption">
Figure 6.2: Plot of dose-effect curve constructed from the dicentric distribution in Table <a href="technical-matters.html#tab:dic-count-data-bad">6.1</a> over an extended <span class="math inline">\(D\)</span> range.
</p>
</div>
<p>It is worth noting that this projection error is particular to Merkle’s method for whole-body assessment and could certainly be circumvented if one chooses to use the delta method instead. However, for optimal dose estimation we expect both the calibration curve and its confidence intervals to define monotonically increasing functions.</p>

</div>



<div class="chapter-nav">
<div class="prev"><a href="manual-use-r.html"><span class="header-section-number">5</span> Usage (R API)</a></div>
<div class="next"><a href="stats-considerations.html"><span class="header-section-number">7</span> Statistical considerations</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#technical-matters"><span class="header-section-number">6</span> Technical matters</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/biodosetools-team/documentation/blob/master/contents/02e_manual_technical_matters.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/biodosetools-team/documentation/edit/master/contents/02e_manual_technical_matters.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Biodose Tools</strong>: User Manual &amp; Documentation" was written by Alfredo Hernández, Joan Francesc Barquinero. It was last built on 2022-12-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
