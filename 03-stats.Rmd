# (PART) Statistical Methods {-}

# Introduction {#stats-intro}
Here is a review of existing statistical methods for the different implemented modules, i.e., 
 
- Dicentric analysis
- Translocation analysis

The primary objective of this section is to provide biologists with technical information about the statistical methods and tests used on Biodose Tools. The main source is [@IAEA2001]

```{r include=FALSE}
library(tidyverse)
```

# Dicentric analysis {#stats-dicent}

## Dose-effect curve fitting

```{r echo=FALSE}
mytable <- data.table::fread("data/count-data-IAEA.csv")

mytable <- mytable %>%
  dplyr::mutate(
    N = 0,
    X = 0,
    DI = 0,
    u = 0
  ) %>%
  dplyr::select(D, N, X, everything())

first_aberr_index <- 4
last_aberr_index <- ncol(mytable) - 2
num_rows <- nrow(mytable)

mytable <- mytable %>%
  dplyr::mutate(
    D = as.numeric(D),
    X = as.integer(X),
    N = as.integer(rowSums(.[first_aberr_index:last_aberr_index]))
  )

# Ugly method to calculate index of dispersion
for (row in 1:num_rows) {
  xf <- 0
  x2f <- 0
  # Calculate summatories
  for (k in seq(0, last_aberr_index - first_aberr_index, 1)) {
    xf <- xf + mytable[row, grep("C", names(mytable), value = T)][k + 1] * k
    x2f <- x2f + mytable[row, grep("C", names(mytable), value = T)][k + 1] * k^2
  }
  # Calculate variance and mean
  var <- (x2f - (xf^2) / mytable[row, "N"]) / (mytable[row, "N"] - 1)
  mean <- xf / mytable[row, "N"]
  # Save values into data frame
  mytable[row, "X"] <- as.integer(xf)
  mytable[row, "DI"] <- var / mean
  mytable[row, "u"] <- (var / mean - 1) * sqrt((mytable[row, "N"] - 1) / (2 * (1 - 1 / mytable[row, "X"])))
}

knitr::kable(mytable)
```

[Download dicentrics distribution](data/count-data-IAEA.csv)

## Dose estimation

# Translocation analysis {#stats-trans}

## Dose-effect curve fitting

## Dose estimation
